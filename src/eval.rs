use crate::position::Position;
use crate::types::*;

#[rustfmt::skip]
pub const PSQT: [[f32; 64]; 15] = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ], [0.03499169647693634, -0.017667274922132492, 0.035835109651088715, 0.010166705586016178, -0.013730419799685478, -0.026355545967817307, -0.012995760887861252, 0.031152423471212387, 0.4322277009487152, 0.4832354784011841, 0.32826414704322815, 0.3282035291194916, 0.28739482164382935, 0.524249255657196, 0.5380920767784119, 0.401576966047287, 0.4760022759437561, 0.5196413397789001, 0.4098707139492035, 0.3931696116924286, 0.3756712079048157, 0.3995172083377838, 0.5341928005218506, 0.4315313994884491, 0.46126341819763184, 0.5251669883728027, 0.48339587450027466, 0.4538116455078125, 0.44898101687431335, 0.4274231791496277, 0.5296933650970459, 0.4451771378517151, 0.5506563782691956, 0.5952807068824768, 0.5333256721496582, 0.46216830611228943, 0.602958083152771, 0.523040771484375, 0.5627160668373108, 0.44023019075393677, 0.7822585105895996, 0.7053749561309814, 0.7904970645904541, 0.7800086140632629, 0.7942073941230774, 0.8720849752426147, 0.7603604793548584, 0.5701431035995483, 1.1923187971115112, 1.1663740873336792, 1.1507242918014526, 0.9903217554092407, 0.9641215205192566, 0.8513973355293274, 0.7750458717346191, 0.9288915395736694, 0.024408705532550812, -0.023278318345546722, 0.0018937840359285474, -0.027087364345788956, 0.022009078413248062, 0.030938956886529922, -0.03206872195005417, -0.024806804955005646, ], [0.37493330240249634, 0.3154807388782501, 0.19729404151439667, 0.22242844104766846, 0.24006052315235138, 0.23095065355300903, 0.34322771430015564, -0.043875858187675476, 0.21257564425468445, 0.35438376665115356, 0.39110514521598816, 0.4917377829551697, 0.5225722789764404, 0.4364013671875, 0.36719831824302673, 0.3022182285785675, 0.30471378564834595, 0.5001114010810852, 0.5471831560134888, 0.602615237236023, 0.6390805840492249, 0.5448746681213379, 0.6257940530776978, 0.4176522493362427, 0.429860919713974, 0.5384383201599121, 0.6697794198989868, 0.6769663095474243, 0.7395791411399841, 0.6658947467803955, 0.6781837344169617, 0.4410361051559448, 0.49950066208839417, 0.641872227191925, 0.7661152482032776, 0.7735968828201294, 0.7965993881225586, 0.9270361065864563, 0.6871499419212341, 0.8070815205574036, 0.6061995029449463, 0.6604838967323303, 0.8007967472076416, 0.8888871073722839, 0.8849294781684875, 0.8555859327316284, 0.8443427085876465, 0.6228554844856262, 0.5360344648361206, 0.6293985843658447, 0.7472750544548035, 0.7926782369613647, 0.8232433795928955, 0.7400627732276917, 0.659392237663269, 0.39363789558410645, 0.41057100892066956, 0.6535567045211792, 0.6668177843093872, 0.5887141823768616, 0.7032321691513062, 0.6000581383705139, 0.5657467246055603, 0.25145700573921204, ], [0.5842103958129883, 0.7077175974845886, 0.542479395866394, 0.4895642101764679, 0.47270068526268005, 0.5911786556243896, 0.5972346067428589, 0.5663349032402039, 0.6924529671669006, 0.7197185158729553, 0.721196711063385, 0.6831274628639221, 0.6703123450279236, 0.6360152959823608, 0.7537181973457336, 0.7257440686225891, 0.6911212205886841, 0.845123291015625, 0.7580277919769287, 0.771176278591156, 0.718060314655304, 0.7476604580879211, 0.8095664381980896, 0.7057545185089111, 0.7749647498130798, 0.7405940890312195, 0.8361025452613831, 0.8488608002662659, 0.866570234298706, 0.8104860782623291, 0.7536012530326843, 0.7475363612174988, 0.7032183408737183, 0.8556734919548035, 0.8033679127693176, 0.9510890245437622, 0.8855285048484802, 0.97331303358078, 0.8090368509292603, 0.7633659243583679, 0.7019734978675842, 0.8706594705581665, 0.8618748188018799, 0.9913880228996277, 0.8961237072944641, 0.9414851665496826, 0.9245415925979614, 0.8986790776252747, 0.7224409580230713, 0.7893965840339661, 0.9298723340034485, 0.903184175491333, 0.8201918005943298, 0.8872276544570923, 0.7641677260398865, 0.7361883521080017, 0.7147595286369324, 0.8967005014419556, 0.7708240747451782, 0.8136988878250122, 0.7761991024017334, 0.6687759757041931, 0.8490127921104431, 0.8849890828132629, ], [1.1725085973739624, 1.2418533563613892, 1.2617042064666748, 1.2574801445007324, 1.2880091667175293, 1.2215238809585571, 1.1917803287506104, 1.1276918649673462, 1.0224465131759644, 1.1115800142288208, 1.1576367616653442, 1.1629115343093872, 1.1611403226852417, 1.2280906438827515, 1.1651296615600586, 1.1221078634262085, 1.0796297788619995, 1.1607458591461182, 1.1227409839630127, 1.1936781406402588, 1.1752758026123047, 1.1400611400604248, 1.2339364290237427, 1.1344939470291138, 1.2251925468444824, 1.3279439210891724, 1.2897439002990723, 1.2819409370422363, 1.3224639892578125, 1.300097107887268, 1.38166344165802, 1.2224220037460327, 1.3841458559036255, 1.382318139076233, 1.4856458902359009, 1.5008885860443115, 1.4666684865951538, 1.4377256631851196, 1.4089404344558716, 1.3687164783477783, 1.5118157863616943, 1.4699394702911377, 1.5616127252578735, 1.592589020729065, 1.5830968618392944, 1.5650075674057007, 1.4586235284805298, 1.4071956872940063, 1.5501399040222168, 1.4985016584396362, 1.5117988586425781, 1.5129598379135132, 1.5831366777420044, 1.5082411766052246, 1.4831210374832153, 1.4949939250946045, 1.5199745893478394, 1.433613896369934, 1.5049651861190796, 1.5387071371078491, 1.5183484554290771, 1.525376796722412, 1.5088632106781006, 1.5016860961914062, ], [1.8583598136901855, 1.8051950931549072, 1.7977445125579834, 1.8493139743804932, 1.861508846282959, 1.6556987762451172, 1.7710082530975342, 1.6481963396072388, 1.808330774307251, 1.81558358669281, 1.8841583728790283, 1.8331799507141113, 1.8499172925949097, 1.8677704334259033, 1.8240923881530762, 1.7933900356292725, 1.7916139364242554, 1.9215508699417114, 1.911260724067688, 1.8790854215621948, 1.881400465965271, 1.8434183597564697, 1.9621195793151855, 1.8049039840698242, 1.837711215019226, 1.8813084363937378, 1.9735872745513916, 2.0295324325561523, 1.958114504814148, 2.021270751953125, 1.9412685632705688, 1.91024649143219, 1.8768887519836426, 1.9255849123001099, 1.9865809679031372, 2.070164442062378, 2.1123087406158447, 2.144368886947632, 2.1134159564971924, 2.0923187732696533, 1.7958910465240479, 1.8997433185577393, 2.017991542816162, 2.0915908813476562, 2.1631271839141846, 2.3464951515197754, 2.3261890411376953, 2.2566311359405518, 1.843324899673462, 1.8969645500183105, 2.0739285945892334, 2.2400155067443848, 2.1170573234558105, 2.156299352645874, 2.2365453243255615, 2.311689615249634, 1.976412057876587, 2.0594513416290283, 2.098710060119629, 2.117429494857788, 2.2292330265045166, 2.2649779319763184, 2.2741873264312744, 2.204941511154175, ], [-0.049267373979091644, 0.13998673856258392, -0.02974594570696354, -0.2807653248310089, -0.23888087272644043, -0.16248819231987, -0.064754918217659, -0.03317728266119957, 0.01806778833270073, 0.01984293758869171, -0.11564747989177704, 0.0004029621777590364, -0.037419579923152924, -0.062190260738134384, 0.0037399663124233484, -0.028050251305103302, -0.0879712775349617, -0.0089493403211236, 0.039172567427158356, 0.06332426518201828, 0.051378220319747925, 0.036927688866853714, 0.0030721169896423817, -0.04296593740582466, -0.11400842666625977, 0.06547561287879944, 0.034461572766304016, 0.12993407249450684, 0.1286403238773346, 0.03047993592917919, 0.0989551767706871, -0.11310239881277084, 0.05185683071613312, 0.15829402208328247, 0.2046724110841751, 0.06182306259870529, 0.12262673676013947, 0.15814825892448425, 0.13988377153873444, 0.009590943343937397, 0.1667119413614273, 0.21492710709571838, 0.17196586728096008, 0.0826757624745369, 0.06612984091043472, 0.1961866170167923, 0.2330635040998459, 0.043744757771492004, -0.005545247811824083, 0.22398830950260162, 0.2481880784034729, 0.30358681082725525, 0.15966355800628662, 0.25449496507644653, 0.2147534340620041, 0.08290418982505798, -0.12624868750572205, 0.11168226599693298, 0.054314736276865005, 0.20359449088573456, 0.21172752976417542, 0.025233931839466095, 0.08139393478631973, 0.07972480356693268, ], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ], [-0.030047405511140823, -0.00197387277148664, -0.01687440648674965, -0.003206004621461034, 0.004533212631940842, -0.025906339287757874, 0.0297214537858963, 0.03402156010270119, -1.1492016315460205, -1.0987093448638916, -1.1021226644515991, -0.9429094791412354, -0.9696864485740662, -0.9018040299415588, -0.9208599328994751, -0.873908281326294, -0.7152392268180847, -0.7856016159057617, -0.8107543587684631, -0.8221892714500427, -0.8082882165908813, -0.711601972579956, -0.7261374592781067, -0.6452285051345825, -0.581015944480896, -0.6003433465957642, -0.6213107109069824, -0.5023720860481262, -0.5498870015144348, -0.5062031149864197, -0.549365222454071, -0.4929274618625641, -0.5025579333305359, -0.5561107993125916, -0.49563631415367126, -0.47452834248542786, -0.4678567051887512, -0.42770978808403015, -0.5048254132270813, -0.4474239945411682, -0.4776715040206909, -0.4653565287590027, -0.4612778127193451, -0.3941912353038788, -0.42322349548339844, -0.46014562249183655, -0.5393552780151367, -0.4612220823764801, -0.4682197868824005, -0.4698767364025116, -0.3946841359138489, -0.3142167329788208, -0.3148316740989685, -0.5185812711715698, -0.5551942586898804, -0.43081134557724, -0.0022193517070263624, 0.004997440613806248, 0.004352275747805834, 0.008702845312654972, -0.030819756910204887, 0.02719627320766449, 0.007118596695363522, 0.03026438318192959, ], [-0.410383015871048, -0.38261154294013977, -0.7420908212661743, -0.7166708111763, -0.7860984206199646, -0.637772262096405, -0.6214743256568909, -0.20522254705429077, -0.46286845207214355, -0.616377055644989, -0.7903438210487366, -0.7654949426651001, -0.8393039703369141, -0.8687723278999329, -0.775404691696167, -0.5567688345909119, -0.5316351652145386, -0.6551307439804077, -0.8748387694358826, -0.8813984394073486, -0.9507350325584412, -0.978278398513794, -0.7741925716400146, -0.6083470582962036, -0.6177425980567932, -0.6421987414360046, -0.8452668786048889, -0.842046856880188, -0.8073663711547852, -0.9167281985282898, -0.7729762196540833, -0.664976954460144, -0.47924530506134033, -0.5216934680938721, -0.7224316596984863, -0.6133471131324768, -0.698500394821167, -0.6608446836471558, -0.6621077060699463, -0.5711426734924316, -0.37317579984664917, -0.4796402156352997, -0.5268393754959106, -0.5943318009376526, -0.6108325719833374, -0.5768236517906189, -0.46901315450668335, -0.3407122790813446, -0.22108839452266693, -0.20638592541217804, -0.406212717294693, -0.44893354177474976, -0.47862309217453003, -0.39964497089385986, -0.4195079505443573, -0.3105011284351349, -0.18325842916965485, -0.34091469645500183, -0.0762421041727066, -0.22864900529384613, -0.3548184633255005, -0.18142050504684448, -0.3594296872615814, -0.043915264308452606, ], [-0.6768136620521545, -0.8730716109275818, -0.8489927649497986, -0.8397102355957031, -0.874918520450592, -0.5844754576683044, -0.8560483455657959, -0.8075220584869385, -0.6385874152183533, -0.873138964176178, -0.925434947013855, -0.8504119515419006, -0.81208336353302, -0.8295122981071472, -0.7233873605728149, -0.816053569316864, -0.6453112959861755, -0.8940884470939636, -0.8673913478851318, -0.9050057530403137, -0.9527686238288879, -0.9341416358947754, -0.9920701384544373, -0.847676694393158, -0.702851414680481, -0.784832775592804, -0.8522851467132568, -0.9375636577606201, -0.9877421259880066, -0.9380087852478027, -0.7816725969314575, -0.8238759636878967, -0.7178844809532166, -0.7686321139335632, -0.7910113334655762, -0.854587733745575, -0.8874704241752625, -0.8031560182571411, -0.7638304233551025, -0.7007784247398376, -0.6754648089408875, -0.7106414437294006, -0.8134469985961914, -0.7970216274261475, -0.8127511739730835, -0.7963094115257263, -0.7366915345191956, -0.6722331643104553, -0.7039941549301147, -0.738959789276123, -0.7593123316764832, -0.62177973985672, -0.7140427231788635, -0.7170857787132263, -0.8066414594650269, -0.6001721620559692, -0.5976419448852539, -0.6449763774871826, -0.5935046076774597, -0.5622631907463074, -0.49897944927215576, -0.561099648475647, -0.49567270278930664, -0.5855962634086609, ], [-1.5340895652770996, -1.5213552713394165, -1.4761126041412354, -1.5502420663833618, -1.56482994556427, -1.494583249092102, -1.5331144332885742, -1.6011720895767212, -1.5141938924789429, -1.514041543006897, -1.5393812656402588, -1.6123069524765015, -1.6131597757339478, -1.4953783750534058, -1.505632996559143, -1.4850773811340332, -1.508048176765442, -1.5160596370697021, -1.4764686822891235, -1.5332938432693481, -1.5986779928207397, -1.6027038097381592, -1.5474172830581665, -1.476883053779602, -1.3572684526443481, -1.414800763130188, -1.473235011100769, -1.5792286396026611, -1.4625869989395142, -1.5162140130996704, -1.4075074195861816, -1.4299931526184082, -1.1874518394470215, -1.3253449201583862, -1.3130277395248413, -1.2662341594696045, -1.2880946397781372, -1.2320975065231323, -1.3485803604125977, -1.1915239095687866, -1.0719050168991089, -1.1725574731826782, -1.1717121601104736, -1.1687757968902588, -1.1875665187835693, -1.1297950744628906, -1.3175667524337769, -1.173289179801941, -1.0438963174819946, -1.0746734142303467, -1.1334068775177002, -1.1483792066574097, -1.12826669216156, -1.1692910194396973, -1.180952548980713, -1.0618863105773926, -1.1612337827682495, -1.2072848081588745, -1.2338489294052124, -1.2622106075286865, -1.2412769794464111, -1.1988520622253418, -1.1179999113082886, -1.0970245599746704, ], [-2.0984389781951904, -2.1447246074676514, -2.245551347732544, -2.2356908321380615, -2.2312428951263428, -2.241443634033203, -2.2964441776275635, -2.2056643962860107, -1.815226674079895, -1.8620671033859253, -2.0251948833465576, -2.185373544692993, -2.2070538997650146, -2.184239387512207, -2.1618123054504395, -2.341245412826538, -1.87353515625, -1.9114583730697632, -1.9056411981582642, -2.1109538078308105, -2.1986358165740967, -2.3433094024658203, -2.26613450050354, -2.112172842025757, -1.8201786279678345, -1.8983861207962036, -2.0807135105133057, -2.03540301322937, -2.134772777557373, -2.1866917610168457, -2.0790035724639893, -2.0257084369659424, -1.843528151512146, -1.8575873374938965, -1.9226206541061401, -1.9421223402023315, -1.967886209487915, -1.953359842300415, -2.0171315670013428, -1.9584418535232544, -1.8398171663284302, -1.8395490646362305, -1.9235292673110962, -1.829401969909668, -1.868409276008606, -1.8633962869644165, -1.9885390996932983, -1.7621790170669556, -1.7738488912582397, -1.806174874305725, -1.864030122756958, -1.7878609895706177, -1.8125303983688354, -1.7771164178848267, -1.805962324142456, -1.5844932794570923, -1.9282160997390747, -1.7195237874984741, -1.7291584014892578, -1.8129836320877075, -1.7175928354263306, -1.4814926385879517, -1.5035631656646729, -1.561594843864441, ], [0.03422956541180611, -0.03609401360154152, -0.23220022022724152, -0.26429054141044617, -0.1339208036661148, -0.3442768156528473, -0.11851932853460312, -0.07295530289411545, -0.12802712619304657, -0.27804267406463623, -0.20423471927642822, -0.2900187075138092, -0.22981317341327667, -0.20282919704914093, -0.3081921637058258, -0.19696323573589325, -0.15492795407772064, -0.24012291431427002, -0.1832895427942276, -0.11042668670415878, -0.061004944145679474, -0.2590330243110657, -0.2528616786003113, -0.1152762770652771, -0.17246103286743164, -0.18135996162891388, -0.2626227140426636, -0.17623072862625122, -0.17488686740398407, -0.19846028089523315, -0.22424666583538055, -0.058063119649887085, 0.10044902563095093, -0.04921950772404671, -0.15433178842067719, -0.14467836916446686, -0.17493976652622223, -0.07271995395421982, -0.10404158383607864, 0.043968986719846725, 0.16520561277866364, 0.04813903197646141, -0.08697811514139175, -0.08611465990543365, -0.05137190222740173, -0.04167246073484421, 0.02562178298830986, 0.10819387435913086, 0.09191762655973434, 0.048835597932338715, 0.07864372432231903, 0.07759714871644974, 0.035183604806661606, 0.06666707247495651, 0.024225151166319847, 0.04209209233522415, 0.13674932718276978, -0.07107912749052048, 0.0041373539716005325, 0.3016873002052307, 0.235778346657753, 0.2018834501504898, 0.04164557531476021, 0.07199028134346008, ], ];
pub const TEMPO_BONUS: f32 = 0.1511647254228592;
pub const BIAS: f32 = 0.001366127165965736;
pub fn eval(pos: &Position) -> i32 {
    let mut eval: f32 = BIAS;

    for &color in [WHITE, BLACK].iter() {
        for &pt in [PAWN, KNIGHT, BISHOP, ROOK, QUEEN, KING].iter() {
            for sq in pos.piece_bb(pt, color) {
                eval += PSQT[make_piece(color, pt) as usize][sq as usize];
            }
        }
    }

    eval = if pos.ctm == WHITE { eval } else { -eval } + TEMPO_BONUS;
    (eval * 100.).round() as i32
}
